x = "Language",
y = "Number of native speakers")
# Plot
ggplot(data = world)+
geom_sf() +
theme_void()
#map of africa from the coordinate i got from filtering the world data
ggplot(data = africa_mapfile) +
geom_sf() +
theme_void()
ggplot(data = joined) +
geom_sf(aes(fill = language)) +
theme_void()
joined
joined |> filter(language == "Arabic")
arabic <- joined |> filter(language == "Arabic")
ggplot(data = arabic) +
geom_sf(aes(fill = language)) +
theme_void()
?if-else
?if_else
joined |>
mutate(spoken_language = if_else(language == "Arabic", "Arabic", "Other"))
arabic <- joined |>
mutate(spoken_language = if_else(language == "Arabic", "Arabic", "Other"))
ggplot(data = arabic) +
geom_sf(aes(fill = spoken_language)) +
theme_void()
arabic <- joined |>
mutate(spoken_language = if_else(language == "Arabic", "Arabic", "Other")) |>
filter(country == "Morocco")
joined |>
mutate(spoken_language = if_else(language == "Arabic", "Arabic", "Other")) |>
filter(country == "Morocco")
africa |> filter(language == "Arabic")
africa |> filter(language == "Arabic") |>
mutate(spoken_language = language)
arabic_africca <- africa |> filter(language == "Arabic") |>
mutate(spoken_language = language)
arabic <- africa |> filter(language == "Arabic") |>
mutate(spoken_language = language)
joined_arabic <- left_join(joined, arabic, by = "country")
joined_arabic
joined_arabic <- left_join(joined, arabic, by = "country") |>
mutate(spoken_language = if_else(spoken_language == "Arabic", "Arabic", "Other"))
joined_arabic
left_join(joined, arabic, by = "country") |>
mutate(spoken_language = case_when(spoken_language == "Arabic" ~ "Arabic",
spoken_languages == NA ~ "Other"))
left_join(joined, arabic, by = "country") |>
mutate(spoken_language = case_when(spoken_language == "Arabic" ~ "Arabic",
spoken_language == NA ~ "Other"))
joined_arabic <- left_join(joined, arabic, by = "country") |>
mutate(spoken_language = case_when(spoken_language == "Arabic" ~ "Arabic",
spoken_language == is.na(spoken_language) ~ "Other"))
joined_arabic
left_join(joined, arabic, by = "country") |>
mutate(spoken_language = case_when(
spoken_language == "Arabic" ~ "Arabic",
is.na(spoken_language)      ~ "Other",
TRUE                        ~ spoken_language  # Keeps everything else as is
))
left_join(joined, arabic, by = "country") |>
mutate(spoken_language = case_when(
spoken_language == "Arabic" ~ "Arabic",
is.na(spoken_language)      ~ "Other"
))
joined_arabic <- left_join(joined, arabic, by = "country") |>
mutate(spoken_language = case_when(spoken_language == "Arabic" ~ "Arabic",
is.na(spoken_language) ~ "Other"))
joined_arabic
ggplot(data = joined_arabic) +
geom_sf(aes(fill = spoken_language)) +
theme_void()
ggplot(data = joined_arabic) +
geom_sf(aes(fill = spoken_language)) +
theme_void() +
scale_fill_viridis_c()
ggplot(data = joined_arabic) +
geom_sf(aes(fill = spoken_language)) +
theme_void() +
scale_fill_viridis_b()
ggplot(data = joined_arabic) +
geom_sf(aes(fill = spoken_language)) +
theme_void() +
scale_fill_viridis_d()
ggplot(data = joined_arabic) +
geom_sf(aes(fill = spoken_language)) +
theme_void() +
scale_colour_viridis_d()
ggplot(data = joined_arabic) +
geom_sf(aes(fill = spoken_language)) +
theme_void() +
scale_color_viridis_d()
scale_color_viridis_d()
?scale_color_viridis_d()
ggplot(data = joined_arabic) +
geom_sf(aes(fill = spoken_language)) +
theme_void() +
scale_fill_viridis_d()
left_join(joined, arabic, by = "country") |>
mutate(spoken_language = case_when(spoken_language == "Arabic" ~ "Arabic",
is.na(spoken_language) ~ "Other")) |>
summarize(n_df = n(spoken_language))
left_join(joined, arabic, by = "country") |>
mutate(spoken_language = case_when(spoken_language == "Arabic" ~ "Arabic",
is.na(spoken_language) ~ "Other")) |>
summarize(n_df = n())
joined_arabic
joined_arabic |> group_by(POP_RANK) |>
summarise(n_df = n())
joined_arabic |> group_by(POP_RANK) |>
summarise(n_df = n())
hpi_df
hpi_df <- read_csv("https://raw.githubusercontent.com/highamm/ds234_quarto/main/data_online/hpi-tidy.csv")
hpi_df
hpi_df |> group_by(Footprint) |>
summarise(n_df = n())
hpi_df |> group_by(Footprint) |>
summarise(n_df = n()) |>
slice(2)
babynames
babynames
library(babynames)
babynames
babynames |> filter(year == 2017)
babynames |> filter(year == 2017)
babynames |> filter(year == 2017)
babynames |> filter(year == 2017) |>
filter(sex == "M")
babynames |> filter(year == 2017) |>
filter(sex == "M") |>
arrange(desc(n))
babynames |> filter(year == 2017) |>
filter(sex == "M") |>
arrange(desc(n)) |>
slice(1:10)
babynames_10 <- babynames |> filter(year == 2017) |>
filter(sex == "M") |>
arrange(desc(n)) |>
slice(1:10)
babynames |> filter(sex == "F") |>
filter(name == "Arthur")
babynames |> filter(sex == "F") |>
filter(name == "Arthur") |>
filter(year >= 2000)
babynames |> filter(sex == "F") |>
filter(name == "Matlala")
babynames |> filter(sex == "F") |>
filter(name == "Lala")
babynames |> filter(sex == "F") |>
filter(name == "Lala") |>
filter(year >= 2000)
babynames |> filter(sex == "M") |>
filter(name == "Lala") |>
filter(year >= 2000)
babynames |> filter(sex == "M") |>
filter(name == "Lala")
babynames |> filter(year != 2000)
ggplot(data = most_spoken10, aes(x = language, y = native_speakers)) +
geom_col(fill = "purple") +
coord_flip() +
theme_minimal() +
labs(title = "Top 10 languages with the most native speakers in Africa",
x = "Language",
y = "Number of native speakers")
library(tidyverse)
ggplot(data = most_spoken10, aes(x = language, y = native_speakers)) +
geom_col(fill = "purple") +
coord_flip() +
theme_minimal() +
labs(title = "Top 10 languages with the most native speakers in Africa",
x = "Language",
y = "Number of native speakers")
ggplot(data = joined_arabic) +
geom_sf(aes(fill = spoken_language)) +
theme_void() +
scale_fill_viridis_d()
?scale_fill_viridis_d()
? scale_fill_distiller()
ggplot(data = joined_arabic) +
geom_sf(aes(fill = spoken_language)) +
theme_void() +
scale_fill_distiller(type = "qual")
ggplot(data = joined_arabic) +
geom_sf(aes(fill = spoken_language)) +
theme_void() +
scale_fill_distiller(type = "seq")
ggplot(data = joined_arabic) +
geom_sf(aes(fill = spoken_language)) +
theme_void() +
scale_fill_viridis_d()
ggplot(data = most_spoken10, aes(x = language, y = native_speakers)) +
geom_col(fill = "purple") +
coord_flip() +
theme_minimal() +
labs(title = "Top 10 languages with the most native speakers in Africa",
x = "Language",
y = "Number of native speakers")
install.packages("here")
library(tidyverse)
library(here)
athletes_df <- read_csv(here("data/athletesdata.csv"))
athletes_df <- read_csv(here("data/coffee_ratings.csv"))
#step 2: Creating a grid of predictor values and using ggpredict() to obtain predictions
ggpredict(mod_age, terms = "age")
# Chunk 1
## install.packages("ggeffects")
library(openintro)
library(tidyverse)
library(ggeffects)
theme_set(theme_minimal())
evals <- openintro::evals
# Chunk 2
# fitted linear regression model
ggplot(data = evals, aes(x = age, y = score)) +
geom_point() +
geom_smooth(method = "lm")
# step-by-step version of the above model visualization
# step 1: fitting the model and getting model summary
#install.packages("broom")
library(broom)
mod_age <- lm(score ~ age, data = evals)
mod_age |> tidy() # makes tibble with model summary
#step 2: Creating a grid of predictor values and using ggpredict() to obtain predictions
ggpredict(mod_age, terms = "age")
# converting the output to a tibble() and renaming some of the terms in the output
ggpredict(mod_age, terms = "age") |> as.data.frame(terms_to_colnames = TRUE) |>
as_tibble()
#  explicitly giving the function values of age that we want in our grid:
ggpredict(mod_age, terms = "age [28:74]") |> as.data.frame(terms_to_colnames = TRUE) |>
as_tibble()
# obtaining predictions for score at the minimum, Q1, median, Q3, and maximum values for age:
ggpredict(mod_age, terms = "age [fivenum]") |>
as.data.frame(terms_to_colnames = TRUE) |>
as_tibble()
# Step 4: Using ggplot2 with the predictions from ggpredict()
pred_evals <- ggpredict(mod_age, terms = "age") |>
as.data.frame(terms_to_colnames = TRUE) |>
as_tibble()
ggplot(data = evals, aes(x = age, y = score)) +
geom_point() +
geom_line(data = pred_evals, aes(x = age, y = predicted),
colour = "blue", linewidth = 1.2)  #we used the pred_evals data frame for the geom_line only
# using the geom_ribbon() function to add a measure of uncertainty to our plot and generate the 95% confidence band:
ggplot(data = evals, aes(x = age, y = score)) +
geom_point() +
geom_line(data = pred_evals, aes(x = age, y = predicted),
colour = "blue", linewidth = 1.2) +
geom_ribbon(data = pred_evals, aes(y = predicted,
ymin = conf.low,
ymax = conf.high),
alpha = 0.4)
# Chunk 3
pred_evals <- ggpredict(mod_age, terms = "age", interval = "prediction") |>
as.data.frame(terms_to_colnames = TRUE) |>
as_tibble()
ggplot(data = evals, aes(x = age, y = score)) +
geom_point() +
geom_line(data = pred_evals, aes(x = age, y = predicted),
colour = "blue", linewidth = 1.2) +
geom_ribbon(data = pred_evals, aes(y = predicted,
ymin = conf.low,
ymax = conf.high),
alpha = 0.4)
pred_evals <- ggpredict(mod_age, terms = "age",
interval = "confidence") |>
as.data.frame(terms_to_colnames = TRUE) |>
as_tibble()
mod_age_sq <- lm(score ~ age + I(age ^ 2), data = evals)
pred_evals_sq <- ggpredict(mod_age_sq, terms = "age") |>
as.data.frame(terms_to_colnames = TRUE) |>
as_tibble()
pred_evals_sq
plot_df <- bind_rows(lst(pred_evals, pred_evals_sq), .id = "model")
plot_df
ggplot(data = evals, aes(x = age, y = score)) +
geom_point() +
geom_line(data = plot_df, aes(x = age, y = predicted, colour = model),
linewidth = 1.2) +
geom_ribbon(data = plot_df, aes(y = predicted,
ymin = conf.low,
ymax = conf.high,
colour = model),
alpha = 0.4) +
scale_colour_viridis_d()
mod_comp <- lm(score ~ age + bty_avg + age:bty_avg + gender,
data = evals)
mod_comp |> tidy()
pred_comp <- ggpredict(mod_comp, terms = c("bty_avg",
"age [threenum]",
"gender")) |>
as.data.frame(terms_to_colnames = TRUE) |>
as_tibble()
pred_comp
pred_comp
mod_comp
evals
ggplot(data = evals, aes(x = bty_avg, y = score)) +
geom_point() +
geom_line(data = pred_comp, aes(x = bty_avg, y = predicted, colour = gender),
linewidth = 1.2) +
geom_ribbon(data = pred_comp, aes(y = predicted,
ymin = conf.low,
ymax = conf.high,
colour = gender),
alpha = 0.4) +
scale_colour_viridis_d()
ggplot(data = evals, aes(x = bty_avg, y = score)) +
geom_point() +
geom_line(data = pred_comp, aes(x = bty_avg, y = predicted, colour = gender),
linewidth = 1.2) +
geom_ribbon(data = pred_comp, aes(y = predicted,
ymin = conf.low,
ymax = conf.high,
colour = gender),
alpha = 0.4) +
facet_grid(~ age[threenum]) +
scale_colour_viridis_d()
ggplot(data = evals, aes(x = bty_avg, y = score)) +
geom_point() +
geom_line(data = pred_comp, aes(x = bty_avg, y = predicted, colour = age[threenum]),
linewidth = 1.2) +
geom_ribbon(data = pred_comp, aes(y = predicted,
ymin = conf.low,
ymax = conf.high,
colour = gender),
alpha = 0.4) +
facet_grid(~ age) +
scale_colour_viridis_d()
pred_comp
ggplot(data = evals, aes(x = bty_avg, y = score)) +
geom_point() +
geom_line(data = pred_comp, aes(x = bty_avg, y = predicted, colour = age[threenum]),
linewidth = 1.2) +
geom_ribbon(data = pred_comp, aes(y = predicted,
ymin = conf.low,
ymax = conf.high,
colour = gender),
alpha = 0.4) +
facet_grid(~ age) +
scale_colour_viridis_d()
ggplot(data = evals, aes(x = bty_avg, y = score)) +
geom_point() +
geom_line(data = pred_comp, aes(x = bty_avg, y = predicted, colour = age),
linewidth = 1.2) +
geom_ribbon(data = pred_comp, aes(y = predicted,
ymin = conf.low,
ymax = conf.high,
colour = gender),
alpha = 0.4) +
facet_grid(~ age) +
scale_colour_viridis_d()
ggplot(data = pred_comp, aes(x = bty_avg, y = predicted)) +
geom_line(aes(colour = age)) +
facet_wrap(~ gender)
ggplot(data = pred_comp, aes(x = bty_avg, y = predicted)) +
geom_line(aes(colour = age)) +
facet_wrap(~ gender) +
scale_colour_viridis_d()
ggplot(data = pred_comp, aes(x = bty_avg, y = predicted)) +
geom_line(aes(colour = age)) +
facet_wrap(~ gender) +
geom_ribbon(aes(y = predicted,
ymin = conf.low,
ymax = conf.high,
colour = age),
alpha = 0.4) +
scale_colour_viridis_d()
ggplot(data = pred_comp, aes(x = bty_avg, y = predicted)) +
geom_line(aes(colour = age)) +
facet_wrap(~ gender) +
geom_ribbon(aes(y = predicted,
ymin = conf.low,
ymax = conf.high,
colour = age),
alpha = 0.14) +
scale_colour_viridis_d()
ggplot(data = pred_comp, aes(x = bty_avg, y = predicted)) +
geom_line(aes(colour = age)) +
facet_wrap(~ gender) +
geom_ribbon(aes(y = predicted,
ymin = conf.low,
ymax = conf.high,
fill = age),
alpha = 0.14) +
scale_colour_viridis_d()
ggplot(data = pred_comp, aes(x = bty_avg, y = predicted)) +
geom_line(aes(colour = age)) +
facet_wrap(~ gender) +
geom_ribbon(aes(y = predicted,
ymin = conf.low,
ymax = conf.high,
fill = age),
alpha = 0.14) +
scale_colour_viridis_d()
ggplot(data = pred_comp, aes(x = bty_avg, y = predicted)) +
geom_line(aes(colour = age)) +
facet_wrap(~ gender) +
geom_ribbon(aes(y = predicted,
ymin = conf.low,
ymax = conf.high,
fill = age),
alpha = 0.14) +
scale_colour_viridis_d() +
scale_fill_viridis_d()
ggplot(data = pred_comp, aes(x = bty_avg, y = predicted)) +
geom_line(aes(colour = age)) +
facet_wrap(~ gender) +
geom_ribbon(aes(y = predicted,
ymin = conf.low,
ymax = conf.high,
fill = age),
alpha = 0.14) +
geom_point(data = evals, aes(y = score)) +
scale_colour_viridis_d() +
scale_fill_viridis_d()  #for the uncertainty bands colour
ggplot(data = pred_comp, aes(x = bty_avg, y = predicted)) +
geom_line(aes(colour = age)) +
facet_wrap(~ gender) +
geom_ribbon(aes(y = predicted,
ymin = conf.low,
ymax = conf.high,
fill = age),
alpha = 0.14) +  # alpha brings transparency to the color of the bands
geom_point(data = evals, aes(y = score), alpha = 0.3) +
scale_colour_viridis_d() +
scale_fill_viridis_d()  #for the uncertainty bands colour
ggplot(data = pred_comp, aes(x = bty_avg, y = predicted)) +
geom_point(data = evals, aes(y = score), alpha = 0.3) +
geom_line(aes(colour = age)) +
facet_wrap(~ gender) +
geom_ribbon(aes(y = predicted,
ymin = conf.low,
ymax = conf.high,
fill = age),
alpha = 0.14) +  # alpha brings transparency to the color of the bands
scale_colour_viridis_d() +
scale_fill_viridis_d()  #for the uncertainty bands colour
ggplot(data = pred_comp, aes(x = bty_avg, y = predicted)) +
geom_point(data = evals, aes(x = bty_avg , y = score), alpha = 0.3) +
geom_line(aes(colour = age)) +
facet_wrap(~ gender) +
geom_ribbon(aes(y = predicted,
ymin = conf.low,
ymax = conf.high,
fill = age),
alpha = 0.14) +  # alpha brings transparency to the color of the bands
scale_colour_viridis_d() +
scale_fill_viridis_d()  #for the uncertainty bands colour
ggplot(data = pred_comp, aes(x = bty_avg, y = predicted)) +
geom_point(data = evals, aes(x = bty_avg , y = score), alpha = 0.3) +
geom_line(aes(colour = age), linewidth = 1.5) +
facet_wrap(~ gender) +
geom_ribbon(aes(y = predicted,
ymin = conf.low,
ymax = conf.high,
fill = age),
alpha = 0.14) +  # alpha brings transparency to the color of the bands
scale_colour_viridis_d() +
scale_fill_viridis_d()  #for the uncertainty bands colour
evals
mod_comp <- lm(score ~ age + gender + age:gender + ethnicity,
data = evals)
mod_comp |> tidy()
mod_comp2 <- lm(score ~ age + gender + age:gender + ethnicity,
data = evals)
mod_comp <- lm(score ~ age + bty_avg + age:bty_avg + gender,
data = evals)
mod_comp2 <- lm(score ~ age + gender + age:gender + ethnicity,
data = evals)
pred_comp <- ggpredict(mod_comp, terms = c("age",
"gender",
"ethnicity")) |>
as.data.frame(terms_to_colnames = TRUE) |>
as_tibble()
pred_comp <- ggpredict(mod_comp2, terms = c("age",
"gender",
"ethnicity")) |>
as.data.frame(terms_to_colnames = TRUE) |>
as_tibble()
pred_comp2 <- ggpredict(mod_comp2, terms = c("age",
"gender",
"ethnicity")) |>
as.data.frame(terms_to_colnames = TRUE) |>
as_tibble()
pred_comp2
ggplot(data = pred_comp2, aes(x = age, y = predicted)) +
geom_point(data = evals, aes(x = age , y = score), alpha = 0.3) +
geom_line(aes(colour = gender), linewidth = 1.5) +
facet_wrap(~ ethnicity) +
scale_colour_viridis_d()
mod_comp3 <- lm(score ~ age + gender + ethnicity,
data = evals)
mod_comp3 |> tidy()
pred_comp3 <- ggpredict(mod_comp3, terms = c("age",
"gender",
"ethnicity")) |>
as.data.frame(terms_to_colnames = TRUE) |>
as_tibble()
pred_comp3
pred_comp2 <- ggpredict(mod_comp2, terms = c("age",
"gender",
"ethnicity")) |>
as.data.frame(terms_to_colnames = TRUE) |>
as_tibble()
pred_comp2
ggplot(data = pred_comp3, aes(x = age, y = predicted)) +
geom_point(data = evals, aes(x = age , y = score), alpha = 0.3) +
geom_line(aes(colour = gender), linewidth = 1.5) +
facet_wrap(~ ethnicity) +
scale_colour_viridis_d()
